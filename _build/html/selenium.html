
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>9. 동적 크롤링과 정규 표현식 &#8212; 파이썬을 이용한 퀀트 투자 포트폴리오 만들기</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "hyunyulhenry/quant_py");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="10. 국내 주식 데이터 수집" href="data_korea.html" />
    <link rel="prev" title="8. 정적 크롤링 실습하기" href="crawl_basic.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">파이썬을 이용한 퀀트 투자 포트폴리오 만들기</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="index.html">
   파이썬을 이용한 퀀트 투자 포트폴리오 만들기
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  퀀트와 프로그래밍 기초 배워보기
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="quant_intro.html">
   1. 퀀트에 대해 알아보기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="python.html">
   2. 파이썬 기초 배워보기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="eda.html">
   3. 데이터 분석 배워보기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plot.html">
   4. 데이터 시각화 배워보기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sql.html">
   5. SQL 기초 배워보기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sql_in_python.html">
   6. 파이썬에서 SQL 연결하기
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  크롤링을 이용한 데이터 수집
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="web.html">
   7. 크롤링을 위한 웹 기본지식
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="crawl_basic.html">
   8. 정적 크롤링 실습하기
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   9. 동적 크롤링과 정규 표현식
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data_korea.html">
   10. 국내 주식 데이터 수집
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data_global.html">
   11. 전 세계 주식 데이터 수집하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data_ref.html">
   12. 투자 참고용 데이터 수집
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  포트폴리오 구성, 백테스트 및 매매하기
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="factor.html">
   13. 퀀트 전략을 이용한 종목선정
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="portfolio.html">
   14. 포트폴리오 구성 전략
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="technical.html">
   15. 트레이딩을 위한 기술적 지표
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="backtest.html">
   16. 백테스팅 시뮬레이션
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="api_trading.html">
   17. 증권사 API 연결과 매매하기
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  부록
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="install_python.html">
   파이썬 다운로드 및 설치하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="install_sql.html">
   SQL 다운로드 및 설치하기
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/selenium.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/hyunyulhenry/quant_py/main?urlpath=tree/selenium.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   9.1. 동적 크롤링이란?
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     9.1.1. 셀레니움 실습하기
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     9.1.2. 셀레니움 명령어 정리
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       9.1.2.1. 브라우저 관련
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id6">
       9.1.2.2. 엘레먼트 접근
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id7">
       9.1.2.3. 동작
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       9.1.2.4. 자바스크립트 코드 실행
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id9">
   9.2. 정규 표현식
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id10">
     9.2.1. 정규 표현식을 알아야 하는 이유
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     9.2.2. 메타문자
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id12">
       9.2.2.1. 문자 클래스([ ])
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id13">
       9.2.2.2. 모든 문자(.)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id14">
       9.2.2.3. 반복문
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id15">
       9.2.2.4. 기타 메타문자
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id16">
     9.2.3. 정규식을 이용한 문자열 검색
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#match">
       9.2.3.1.
       <code class="docutils literal notranslate">
        <span class="pre">
         match()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search">
       9.2.3.2.
       <code class="docutils literal notranslate">
        <span class="pre">
         search()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#findall">
       9.2.3.3.
       <code class="docutils literal notranslate">
        <span class="pre">
         findall()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#finditer">
       9.2.3.4. finditer()
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id17">
     9.2.4. 정규 표현식 연습해보기
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>동적 크롤링과 정규 표현식</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   9.1. 동적 크롤링이란?
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     9.1.1. 셀레니움 실습하기
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     9.1.2. 셀레니움 명령어 정리
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       9.1.2.1. 브라우저 관련
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id6">
       9.1.2.2. 엘레먼트 접근
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id7">
       9.1.2.3. 동작
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       9.1.2.4. 자바스크립트 코드 실행
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id9">
   9.2. 정규 표현식
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id10">
     9.2.1. 정규 표현식을 알아야 하는 이유
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     9.2.2. 메타문자
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id12">
       9.2.2.1. 문자 클래스([ ])
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id13">
       9.2.2.2. 모든 문자(.)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id14">
       9.2.2.3. 반복문
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id15">
       9.2.2.4. 기타 메타문자
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id16">
     9.2.3. 정규식을 이용한 문자열 검색
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#match">
       9.2.3.1.
       <code class="docutils literal notranslate">
        <span class="pre">
         match()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search">
       9.2.3.2.
       <code class="docutils literal notranslate">
        <span class="pre">
         search()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#findall">
       9.2.3.3.
       <code class="docutils literal notranslate">
        <span class="pre">
         findall()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#finditer">
       9.2.3.4. finditer()
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id17">
     9.2.4. 정규 표현식 연습해보기
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="id1">
<h1><span class="section-number">9. </span>동적 크롤링과 정규 표현식<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>이번 장에서는 좀 더 복잡한 형태의 데이터를 크롤링하기 위한 동적 크롤링 및 정규 표현식의 사용방법에 대해 알아보도록 하겠다.</p>
<div class="section" id="id2">
<h2><span class="section-number">9.1. </span>동적 크롤링이란?<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>지난 장에서 크롤링을 통해 웹사이트의 데이터를 수집하는 방법에 대해 배웠다. 그러나 일반적인 크롤링으로는 정적 데이터, 즉 변하지 않는 데이터만을 수집할 수 있다. 한 페이지 안에서 원하는 정보가 모두 드러나는 것을 정적 데이터라 한다. 반면 입력, 클릭, 로그인 등을 통해 데이터가 바뀌는 것을 동적 데이터라 한다. 예를 들어 네이버 지도에서 매장을 검색을 한 후 좌측에서 원하는 선택할 때 마다 이에 해당하는 내용이 뜬다.</p>
<div class="figure align-default" id="twosome">
<img alt="_images/twosome.png" src="_images/twosome.png" />
<p class="caption"><span class="caption-number">Fig. 9.1 </span><span class="caption-text">동적 페이지</span><a class="headerlink" href="#twosome" title="Permalink to this image">¶</a></p>
</div>
<p>이는 웹페이지에서 사용자가 클릭 등과 같은 조작을 하면 AJAX 호출이 발생하여 그 결과가 페이지의 일부분에만 반영되어 변경되기 때문이다. 즉 매장을 클릭하면 웹브라우저가 연결된 자바스크립트 코드를 실행하여 해당 매장의 상세 정보가 동일한 페이지에 동적으로 표시된다. <a class="reference internal" href="#compare"><span class="std std-numref">Fig. 9.2</span></a>은 정적 페이지와 동적 페이지의 작동 방식의 차이를 나타낸다.</p>
<div class="figure align-default" id="compare">
<img alt="_images/compare.png" src="_images/compare.png" />
<p class="caption"><span class="caption-number">Fig. 9.2 </span><span class="caption-text">정적 페이지와 동적 페이지의 차이</span><a class="headerlink" href="#compare" title="Permalink to this image">¶</a></p>
</div>
<p>셀레니움을 이용할 경우 정적 페이지와 동적 페이지를 모두 크롤링 할 수 있다는 강력함이 있지만, 상대적으로 속도가 느리다. 따라서 정적 페이지는 기존의 방법을 이용한 크롤링을, 동적 페이지는 셀레니움을 이용한 크롤링을 하는 것이 일반적이다.</p>
<table class="colwidths-auto table" id="crawl-compare">
<caption><span class="caption-number">Table 9.1 </span><span class="caption-text">정적 크롤링과 동적 크롤링 비교</span><a class="headerlink" href="#crawl-compare" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>구분</p></th>
<th class="head"><p>정적 크롤링</p></th>
<th class="head"><p>동적 크롤링</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>사용 패키지</p></td>
<td><p>requests</p></td>
<td><p>selenium</p></td>
</tr>
<tr class="row-odd"><td><p>수집 커버리지</p></td>
<td><p>정적 페이지</p></td>
<td><p>정적/동적 페이지</p></td>
</tr>
<tr class="row-even"><td><p>수집 속도</p></td>
<td><p>빠름 (별도 페이지 조작 필요 X)</p></td>
<td><p>상대적으로 느림</p></td>
</tr>
<tr class="row-odd"><td><p>파싱 패키지</p></td>
<td><p>beautifulsoup</p></td>
<td><p>beautifulsoup / selenium</p></td>
</tr>
</tbody>
</table>
<p>셀레니움이란 다양한 브라우저(인터넷 익스플로러, 크롬, 사파리 오페라 등) 및 플랫폼에서 웹 응용 프로그램을 테스트할 수 있게 해주는 라이브러리다. 즉 웹 자동화 테스트 용도로 개발이 되었기에 실제 브라우저를 사용하며, 페이지가 변화하는 것도 관찰이 가능하기에 동적 크롤링에 사용할 수 있다.</p>
<div class="section" id="id3">
<h3><span class="section-number">9.1.1. </span>셀레니움 실습하기<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>이제 간단한 예제를 통해 셀레니움 사용법을 알아보도록 하자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.chrome.service</span> <span class="kn">import</span> <span class="n">Service</span>
<span class="kn">from</span> <span class="nn">webdriver_manager.chrome</span> <span class="kn">import</span> <span class="n">ChromeDriverManager</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.by</span> <span class="kn">import</span> <span class="n">By</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.keys</span> <span class="kn">import</span> <span class="n">Keys</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>

<span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="n">Service</span><span class="p">(</span><span class="n">ChromeDriverManager</span><span class="p">()</span><span class="o">.</span><span class="n">install</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="selenium-open">
<img alt="_images/selenium_open1.png" src="_images/selenium_open1.png" />
<p class="caption"><span class="caption-number">Fig. 9.3 </span><span class="caption-text">셀레니움: 창 열기</span><a class="headerlink" href="#selenium-open" title="Permalink to this image">¶</a></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">webdriver.Chrome(service=Service(ChromeDriverManager().install()))</span></code> 코드를 실행하면 크롬 브라우저의 버전을 탐색한 다음, 버전에 맞는 웹드라이버를 다운로드하여 해당 경로를 셀레니움에 전달해준다. 또한 <a class="reference internal" href="#selenium-open"><span class="std std-numref">Fig. 9.3</span></a>와 같이 크롬 창이 열리며, 좌측 상단에 ‘Chrome이 자동화된 테스트 소프트웨어에 의해 제어되고 있습니다.’라는 문구가 뜬다. 이제 파이썬 코드를 이용해 해당 페이지를 조작할 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://www.naver.com/&#39;</span>
<span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">driver</span><span class="o">.</span><span class="n">page_source</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">1000</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;html lang=&quot;ko&quot; data-dark=&quot;false&quot; data-useragent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.79 Safari/537.36&quot;&gt;&lt;head&gt;&lt;script async=&quot;&quot; type=&quot;text/javascript&quot; src=&quot;https://ssl.pstatic.net/tveta/libs/ndpsdk/prod/ndp-core.js&quot;&gt;&lt;/script&gt; &lt;meta charset=&quot;utf-8&quot;&gt; &lt;title&gt;NAVER&lt;/title&gt; &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=1190&quot;&gt; &lt;meta name=&quot;apple-mobile-web-app-title&quot; content=&quot;NAVER&quot;&gt; &lt;meta name=&quot;robots&quot; content=&quot;index,nofollow&quot;&gt; &lt;meta name=&quot;description&quot; content=&quot;네이버 메인에서 다양한 정보와 유용한 컨텐츠를 만나 보세요&quot;&gt; &lt;meta property=&quot;og:title&quot; content=&quot;네이버&quot;&gt; &lt;meta property=&quot;og:url&quot; content=&quot;https://www.naver.com/&quot;&gt; &lt;meta property=&quot;og:image&quot; content=&quot;https://s.pstatic.net/static/www/mobile/edit/2016/0705/mobile_212852414260.png&quot;&gt; &lt;meta property=&quot;og:description&quot; content=&quot;네이버 메인에서 다양한 정보와 유용한 컨텐츠를 만나 보세요&quot;&gt; &lt;meta name=&quot;twitter:card&quot; content=&quot;summary&quot;&gt; &lt;meta name=&quot;twitter:title&quot; content=&quot;&quot;&gt; &lt;meta name=&quot;twitter:url&#39;
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="selenium-naver">
<img alt="_images/selenium_naver.png" src="_images/selenium_naver.png" />
<p class="caption"><span class="caption-number">Fig. 9.4 </span><span class="caption-text">셀레니움을 이용한 네이버 접속</span><a class="headerlink" href="#selenium-naver" title="Permalink to this image">¶</a></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">driver.get()</span></code> 내에 URL 주소를 입력하면 해당 주소로 이동한다. 또한 <code class="docutils literal notranslate"><span class="pre">driver.page_source</span></code>를 통해 열려있는 창의 HTML 코드를 확인할 수도 있다. 이제 네이버 메인에서 [뉴스]버튼을 누르는 동작을 실행해보자. 개발자도구 화면을 통해 확인해보면 [뉴스] 탭은 아래 HTML에 위치하고 있다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;https://news.naver.com/&quot;</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;nav&quot;</span> <span class="n">data</span><span class="o">-</span><span class="n">clk</span><span class="o">=</span><span class="s2">&quot;svc.news&quot;</span><span class="o">&gt;</span><span class="n">뉴스</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>위 정보를 통해 해당 부분을 클릭해보도록 하자.</p>
<div class="figure align-default" id="selenium-news">
<img alt="_images/selenium_news.png" src="_images/selenium_news.png" />
<p class="caption"><span class="caption-number">Fig. 9.5 </span><span class="caption-text">뉴스 탭의 HTML 확인</span><a class="headerlink" href="#selenium-news" title="Permalink to this image">¶</a></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">LINK_TEXT</span> <span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;뉴스&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="selenium-news2">
<img alt="_images/selenium_news2.png" src="_images/selenium_news2.png" />
<p class="caption"><span class="caption-number">Fig. 9.6 </span><span class="caption-text">뉴스 탭으로 이동</span><a class="headerlink" href="#selenium-news2" title="Permalink to this image">¶</a></p>
</div>
<p>브라우저 상에서 보이는 버튼, 검색창, 사진, 테이블, 동영상 등을 엘레먼트(element, 요소)라고 한다. <code class="docutils literal notranslate"><span class="pre">find_element()</span></code>는 다양한 방법으로 엘레먼트에 접근하게 해주며, <code class="docutils literal notranslate"><span class="pre">By.*</span></code> 를 통해 어떠한 방법으로 엘레먼트에 접근할지 선언한다. LINK_TEXT의 경우 링크가 달려 있는 텍스트로 접근하며, <code class="docutils literal notranslate"><span class="pre">value</span> <span class="pre">=</span> <span class="pre">'뉴스'</span></code>, 즉 뉴스라는 단어가 있는 엘레먼트로 접근한다. <code class="docutils literal notranslate"><span class="pre">click()</span></code> 함수는 마우스 클릭을 실행하며 결과 적으로 뉴스 탭을 클릭한 후 페이지가 이동되는 것을 확인할 수 있다. <code class="docutils literal notranslate"><span class="pre">find_element()</span></code> 내 접근방법 및 셀레니움의 각종 동작 제어 방법에 대해서는 나중에 다시 정리하도록 한다.</p>
<p>이제 뒤로가기를 실행해보도록 하자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">driver</span><span class="o">.</span><span class="n">back</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">back()</span></code>은 뒤로가기를 의미하며, 기존 페이지인 네이버 메인으로 이동한다.</p>
<p>이제 특정 검색어를 검색하는 방법에 대해 알아보자. 먼저 검색창의 위치가 어디에 있는지 확인해보면 query라는 id와 input_text라는 class에 위치하고 있다.</p>
<div class="figure align-default" id="selenium-search">
<img alt="_images/selenium_search.png" src="_images/selenium_search.png" />
<p class="caption"><span class="caption-number">Fig. 9.7 </span><span class="caption-text">검색 창 위치 확인하기</span><a class="headerlink" href="#selenium-search" title="Permalink to this image">¶</a></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">CLASS_NAME</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;input_text&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s1">&#39;퀀트 투자 포트폴리오 만들기&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="selenium-send-keys">
<img alt="_images/selenium_send_keys.png" src="_images/selenium_send_keys.png" />
<p class="caption"><span class="caption-number">Fig. 9.8 </span><span class="caption-text">검색어 입력하기</span><a class="headerlink" href="#selenium-send-keys" title="Permalink to this image">¶</a></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">find_element()</span></code> 내에 By.CLASS_NAME을 입력하면 클래스 명에 해당하는 엘레먼트에 접근하며, 여기서는 검색창에 접근한다. 그 후 <code class="docutils literal notranslate"><span class="pre">send_keys()</span></code> 내에 텍스트를 입력하면 해당 내용이 웹페이지에 입력된다. 이제 웹페이지에서 검색 버튼 해당하는 돋보기 모양을 클릭하거나 엔터키를 누르면 검색이 실행된다. 먼저 돋보기 모양의 위치를 확인해보면 search_btn id와 btn_submit 클래스에 위치하고 있다.</p>
<div class="figure align-default" id="selenium-searchbutton">
<img alt="_images/selenium_searchbutton.png" src="_images/selenium_searchbutton.png" />
<p class="caption"><span class="caption-number">Fig. 9.9 </span><span class="caption-text">검색 버튼의 위치 확인</span><a class="headerlink" href="#selenium-searchbutton" title="Permalink to this image">¶</a></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">CLASS_NAME</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;btn_submit&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">ENTER</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="selenium-enter">
<img alt="_images/selenium_enter.png" src="_images/selenium_enter.png" />
<p class="caption"><span class="caption-number">Fig. 9.10 </span><span class="caption-text">엔터키 제어하기</span><a class="headerlink" href="#selenium-enter" title="Permalink to this image">¶</a></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">find_element(By.CLASS_NAME,</span> <span class="pre">value</span> <span class="pre">=</span> <span class="pre">'btn_submit')</span></code>를 통해 검색 버튼에 접근한다. 그 후 <code class="docutils literal notranslate"><span class="pre">send_keys(Keys.ENTER)</span></code>를 입력하면 엔터키를 누르는 동작이 실행된다. 페이지를 확인해보면 검색이 실행된 후 결과를 확인할 수 있다.</p>
<p>이번에는 다른 단어를 검색해보도록 하자. 웹에서 기존 검색어 내용을 지운 후, 검색어를 입력하고, 버튼을 클릭해야 한다. 이를 위해 검색어 박스와 검색 버튼의 위치를 찾아보면 다음과 같다.</p>
<ul class="simple">
<li><p>검색어 박스: box_window 클래스</p></li>
<li><p>검색 버튼: bt_search 클래스</p></li>
</ul>
<div class="figure align-default" id="selenium-research">
<img alt="_images/selenium_research.png" src="_images/selenium_research.png" />
<p class="caption"><span class="caption-number">Fig. 9.11 </span><span class="caption-text">검색어 박스와 검색 버튼의 위치 확인</span><a class="headerlink" href="#selenium-research" title="Permalink to this image">¶</a></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">CLASS_NAME</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;box_window&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">CLASS_NAME</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;box_window&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s1">&#39;이현열 퀀트&#39;</span><span class="p">)</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">CLASS_NAME</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;bt_search&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="selenium-research2">
<img alt="_images/selenium_research2.png" src="_images/selenium_research2.png" />
<p class="caption"><span class="caption-number">Fig. 9.12 </span><span class="caption-text">새로운 단어 검색하기</span><a class="headerlink" href="#selenium-research2" title="Permalink to this image">¶</a></p>
</div>
<ol class="simple">
<li><p>검색어 박스(box_window)에 접근한 후, <code class="docutils literal notranslate"><span class="pre">clear()</span></code>를 실행하면 모든 텍스트가 지워진다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">send_keys('이현열</span> <span class="pre">퀀트')</span></code>를 실행하여 새로운 검색어를 입력한다.</p></li>
<li><p>검색 버튼(bt_search)에 접근한 후, <code class="docutils literal notranslate"><span class="pre">click()</span></code>을 실행하여 해당 버튼을 클릭한다.</p></li>
</ol>
<p>이번에는 [VIEW] 버튼을 클릭하는 동작을 실행해보도록 한다. 기존처럼 링크나 클래스명을 통해 엘레먼트에 접근할 수도 있지만, 이번에는 XPATH를 이용해 접근해보도록 하자. XPATH란 XML 중 특정 값의 태그나 속성을 찾기 쉽게 만든 주소다. 예를 들어 윈도우 탐색기에서는 특정 폴더의 위치가 ‘<strong>C:\Program Files</strong>’과 같이 주소처럼 보이며 이는 윈도우의 PATH 문법이다. XML 역시 이와 동일한 개념의 XPATH가 있다. 웹페이지에서 XPATH를 찾는 법은 다음과 같다.</p>
<ol class="simple">
<li><p>개발자도구 화면에서 위치를 찾고 싶은 부분에서 마우스 우클릭을 한다.</p></li>
<li><p>[Copy → Copy Xpath]를 선택한다.</p></li>
</ol>
<div class="figure align-default" id="selenium-xpath">
<img alt="_images/selenium_xpath.png" src="_images/selenium_xpath.png" />
<p class="caption"><span class="caption-number">Fig. 9.13 </span><span class="caption-text">XPATH 찾기 및 복사하기</span><a class="headerlink" href="#selenium-xpath" title="Permalink to this image">¶</a></p>
</div>
<p>위 과정을 통해 XPATH가 복사된다. 메모장을 확인해보면 VEW 부분의 XPATH는 다음과 같다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//*</span><span class="p">[</span><span class="nd">@id</span><span class="o">=</span><span class="s2">&quot;lnb&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">div</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">div</span><span class="o">/</span><span class="n">ul</span><span class="o">/</span><span class="n">li</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">a</span>
</pre></div>
</div>
<p>이를 이용해 해당 부분을 클릭하는 동작을 실행해보자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;lnb&quot;]/div[1]/div/ul/li[2]/a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="selenium-view">
<img alt="_images/selenium_view.png" src="_images/selenium_view.png" />
<p class="caption"><span class="caption-number">Fig. 9.14 </span><span class="caption-text">VIEW 부분으로 이동</span><a class="headerlink" href="#selenium-view" title="Permalink to this image">¶</a></p>
</div>
<p>탭이 [통합] 검색이 아닌 [VIEW]로 변경되었다. 이번에는 [옵션]을 클릭한 후 정렬을 [최신순]으로 하는 동작을 실행해보자. 둘의 위치는 다음과 같다.</p>
<ul class="simple">
<li><p>옵션 버튼: option_filter (클래스)</p></li>
<li><p>최신순 버튼: //*[&#64;id=”snb”]/div[2]/ul/li[2]/div/div/a[2] (Xpath)</p></li>
</ul>
<div class="figure align-default" id="xpath">
<img alt="_images/xpath.png" src="_images/xpath.png" />
<p class="caption"><span class="caption-number">Fig. 9.15 </span><span class="caption-text">옵션 버튼과 최신순 버튼의 위치</span><a class="headerlink" href="#xpath" title="Permalink to this image">¶</a></p>
</div>
<p>코드 실행에 앞서 <a class="reference internal" href="#xpath-close"><span class="std std-numref">Fig. 9.16</span></a>와 같이 옵션 창이 열려있다면 [X] 버튼을 눌러 닫아주도록 한다.</p>
<div class="figure align-default" id="xpath-close">
<img alt="_images/xpath_close.png" src="_images/xpath_close.png" />
<p class="caption"><span class="caption-number">Fig. 9.16 </span><span class="caption-text">옵션 창 닫기</span><a class="headerlink" href="#xpath-close" title="Permalink to this image">¶</a></p>
</div>
<p>옵션 창을 닫은 후 아래의 코드를 실행하도록 한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">CLASS_NAME</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;option_filter&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;snb&quot;]/div[2]/ul/li[2]/div/div/a[2]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="selenium-new">
<img alt="_images/selenium_new.png" src="_images/selenium_new.png" />
<p class="caption"><span class="caption-number">Fig. 9.17 </span><span class="caption-text">최신순 정렬</span><a class="headerlink" href="#selenium-new" title="Permalink to this image">¶</a></p>
</div>
<p>옵션 클릭 후 최신순 버튼을 클릭하는 동작을 수행하여 검색어가 최신순으로 정렬되었다. 이제 page down 기능을 수행해보도록 하자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">driver</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;window.scrollTo(0, document.body.scrollHeight);&#39;</span><span class="p">)</span>
<span class="c1"># driver.find_element(By.TAG_NAME, value = &#39;body&#39;).send_keys(Keys.PAGE_DOWN)</span>
</pre></div>
</div>
</div>
</div>
<p>먼저 <code class="docutils literal notranslate"><span class="pre">document.body.scrollHeight</span></code>는 웹페이지의 높이를 나타내는 것으로써, <code class="docutils literal notranslate"><span class="pre">window.scrollTo(0,</span> <span class="pre">document.body.scrollHeight);</span></code>는 웹페이지의 가장 하단까지 스크롤을 내리라는 자바스크립트 명령어다. <code class="docutils literal notranslate"><span class="pre">driver.execute_script()</span></code>를 통해 해당 명령어를 실행하면 웹페이지가 아래로 스크롤이 이동된다. <code class="docutils literal notranslate"><span class="pre">send_keys(Keys.PAGE_DOWN)</span></code> 는 키보드의 페이지다운(PgDn) 버튼을 누르는 동작이며 이 역시 페이지가 아래로 이동시킨다.</p>
<p>그러나 결과를 살펴보면 스크롤이 끝까지 내려간 후 얼마간의 로딩이 있은 후에 새로운 데이터가 생성된다. 이처럼 유튜브나 인스타그램, 페이스북 등 많은 검색결과를 보여줘야 하는 경우 웹페이지 상에서 한 번에 모든 데이터를 보여주기 보다는 스크롤을 가장 아래로 위치하면 로딩을 거쳐 추가적인 결과를 보여준다. 따라서 스크롤을 한 번만 내리는 것이 아닌 모든 결과가 나올 때까지 내리는 동작을 실행해야 한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prev_height</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;return document.body.scrollHeight&#39;</span><span class="p">)</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">driver</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;window.scrollTo(0, document.body.scrollHeight);&#39;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="n">curr_height</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;return document.body.scrollHeight&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">curr_height</span> <span class="o">==</span> <span class="n">prev_height</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="n">prev_height</span> <span class="o">=</span> <span class="n">curr_height</span>
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">document.body.scrollHeight</span></code>은 현재의 창 높이는 반환하는 자바스크립트 명령어이며, 이를 prev_height에 저장한다.</p></li>
<li><p>while문을 통해 반복문을 실행한다.</p></li>
<li><p>셀레니움을 통해 페이지의 최하단으로 스크롤을 내린다.</p></li>
<li><p>페이지가 로딩되는 시간을 기다리기 위해 2초간 슬립을 준다.</p></li>
<li><p>curr_height에 현재 창 높이를 저장한다.</p></li>
<li><p>curr_height와 prev_height가 동일하다는 의미는 페이지가 끝까지 내려왔다는 의미이다. 따라서 이 경우 <code class="docutils literal notranslate"><span class="pre">break</span></code>를 통해 while문을 멈추며, 그렇지 않을 경우 다시 스크롤을 내리는 동작을 반복한다.</p></li>
<li><p>prev_height에 새로운 창 높이를 입력한다.</p></li>
</ol>
<p>이제 모든 검색 결과가 나타났으면 이전 장에서 살펴보았던 정적 크롤링을 통해 데이터 수집이 가능하다. 제목 부분을 확인해보면 <strong>api_txt_lines total_tit _cross_trigger</strong> 클래스에 위치하고 있으며, 이를 통해 모든 제목을 크롤링해보자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">html</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">driver</span><span class="o">.</span><span class="n">page_source</span><span class="p">,</span> <span class="s1">&#39;lxml&#39;</span><span class="p">)</span>
<span class="n">txt</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="n">class_</span> <span class="o">=</span> <span class="s1">&#39;api_txt_lines total_tit _cross_trigger&#39;</span><span class="p">)</span>
<span class="n">txt_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">txt</span><span class="p">]</span>

<span class="n">txt_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;스마트 베타_김병규, 이현열&#39;,
 &#39;감으로 하는 투자, 데이터로 하는 투자&#39;,
 &#39;[서평] 감으로 하는 투자, 데이터로 하는 투자&#39;,
 &#39;Investment Book 25 - 감으로 하는 투자 데이터로 하는 투자&#39;,
 &#39;퀀트 투자자라면 반드시 생각해야 할 7가지&#39;,
 &#39;[주식] 올라떼 - 구루(guru)들의 주식투자(1탄)&#39;,
 &#39;패스트캠퍼스 캐시백 챌린지 44일차&#39;,
 &#39;[재테크도서] 감으로 하는 투자 데이터로 하는 투자 - 천영록,이현열 저.&#39;,
 &#39;이현열 교수님 퀀트 관련 Q&amp;A 세션&#39;,
 &#39;‘분산-장투해라’ 감으로하는 투자, 데이터로 하는 투자, 천영록-이현열&#39;]
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">driver.page_source</span></code>를 통해 현재 웹페이지의 HTML 정보를 가져올 수 있으며, 이를 BeautifulSoup 객체로 만들어준다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">find_all()</span></code> 함수를 통해 제목 부분에 위치하는 데이터를 모두 불러온다.</p></li>
<li><p>for문을 통해 텍스트만 추출한다.</p></li>
</ol>
<p>이처럼 동적 페이지의 경우도 셀레니움을 통해 웹페이지를 제어한 후 <code class="docutils literal notranslate"><span class="pre">BeautifulSoup</span></code> 패키지를 사용해 원하는 부분을 추출하면 얼마든지 크롤링이 가능하다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">driver</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">driver.quit()</span></code>을 실행하면 열려있던 페이지가 종료된다.</p>
</div>
<div class="section" id="id4">
<h3><span class="section-number">9.1.2. </span>셀레니움 명령어 정리<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>마지막으로 셀레니움의 각종 명령어는 다음과 같다.</p>
<div class="section" id="id5">
<h4><span class="section-number">9.1.2.1. </span>브라우저 관련<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">webdriver.Chrome()</span></code>: 브라우저 열기</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">driver.close()</span></code>: 현재 탭 닫기</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">driver.quit()</span></code>: 브라우저 닫기</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">driver.back()</span></code>: 뒤로 가기</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">driver.forward()</span></code>: 앞으로 가기</p></li>
</ul>
</div>
<div class="section" id="id6">
<h4><span class="section-number">9.1.2.2. </span>엘레먼트 접근<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">driver.find_element(by</span> <span class="pre">=</span> <span class="pre">'id',</span> <span class="pre">value</span> <span class="pre">=</span> <span class="pre">'value')</span></code> 중 by = ‘id’ 부분에 해당하는 방법에 따라 엘레먼트에 접근한다. 또한 <code class="docutils literal notranslate"><span class="pre">find_element()</span></code>는 해당하는 엘레먼트가 여러 개 있을 경우 첫 번째 요소 하나만을 반환하며, <code class="docutils literal notranslate"><span class="pre">find_elements()</span></code>는 여러 엘레먼트가 있을 경우 리스트로 반환한다.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">By.ID</span></code>: 태그의 ID 값으로 추출</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">By.NAME</span></code>: 태그의 NAME 값으로 추출</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">By.XPATH</span></code>: 태그의 XPATH 값으로 추출</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">By.LINK_TEXT</span></code>: 링크에 존재하는 텍스트로 추출</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">By.TAG_NAME</span></code>: 태그명으로 추출</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">By.CLASS_NAME</span></code>: 태그의 클래스명으로 추출</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">By.CSS_SELECTOR</span></code>: CSS 선택자로 추출</p></li>
</ul>
</div>
<div class="section" id="id7">
<h4><span class="section-number">9.1.2.3. </span>동작<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<p>엘레먼트에 접근한 후 각종 동작을 수행할 수 있다.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">click()</span></code>: 엘레먼트를 클릭</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">clear()</span></code>: 텍스트 삭제</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">send_keys(text)</span></code>: 텍스트 입력</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">send_keys(Keys.CONTROL</span> <span class="pre">+</span> <span class="pre">'v')</span></code>: 컨트롤 + v 누르기</p></li>
</ul>
</div>
<div class="section" id="id8">
<h4><span class="section-number">9.1.2.4. </span>자바스크립트 코드 실행<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">execute_script()</span></code> 내에 자바스크립트 코드를 입력하여 여러가지 동작을 수행할 수 있다.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>파이썬 내 셀레니움은 아래 페이지에 상세하게 설명되어 있다.</p>
<p><a class="reference external" href="https://selenium-python.readthedocs.io/">https://selenium-python.readthedocs.io/</a></p>
</div>
</div>
</div>
</div>
<div class="section" id="id9">
<h2><span class="section-number">9.2. </span>정규 표현식<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h2>
<p>정규 표현식(정규식)이란 프로그래밍에서 문자열을 다룰 때 문자열의 일정한 패턴을 표현하는 일종의 형식 언어를 말하며, 영어로는 regular expression를 줄여 일반적으로 regex라 표현한다. 정규 표현식은 파이썬만의 고유 문법이 아니라 문자열을 처리하는 모든 프로그래밍에서 사용되는 공통 문법이기에 한 번 알아두면 파이썬 뿐만 아니라 다른 언어에서도 쉽게 적용할 수 있다. 본 책의 내용은 아래 페이지의 내용을 참고하여 작성되었다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">docs</span><span class="o">.</span><span class="n">python</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="mf">3.10</span><span class="o">/</span><span class="n">howto</span><span class="o">/</span><span class="n">regex</span><span class="o">.</span><span class="n">html</span>
</pre></div>
</div>
<div class="section" id="id10">
<h3><span class="section-number">9.2.1. </span>정규 표현식을 알아야 하는 이유<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<p>만약 우리가 크롤링한 결과물이 다음과 같다고 하자.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;동 기업의 매출액은 전년 대비 29.2% 늘어났습니다.&quot;</span>
</pre></div>
</div>
<p>만일 이 중에서 [29.2%]에 해당하는 데이터만 추출하려면 어떻게 해야 할까? 얼핏 보기에도 꽤나 복잡한 방법을 통해 클렌징을 해야 한다. 그러나 정규 표현식을 이용할 경우 이는 매우 간단한 작업이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>

<span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;동 기업의 매출액은 전년 대비 29.2% 늘어났습니다.&#39;</span>
<span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;\d+.\d+%&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;29.2%&#39;]
</pre></div>
</div>
</div>
</div>
<p>‘\d+.\d+%’라는 표현식은 ‘숫자.숫자%’의 형태를 나타내는 정규 표현식이며, re 모듈의 <code class="docutils literal notranslate"><span class="pre">findall()</span></code> 함수를 통해 텍스트에서 해당 표현식의 글자를 추출할 수 있다. 이제 정규 표현식의 종류에는 어떠한 것들이 있는지 알아보도록 하자.</p>
</div>
<div class="section" id="id11">
<h3><span class="section-number">9.2.2. </span>메타문자<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<p>프로그래밍에서 메타 문자(Meta Characters)란 문자가 가진 원래의 의미가 아닌 특별한 용도로 사용되는 문자를 말한다. 정규 표현식에서 사용되는 메타 문자는 다음과 같다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>. ^ $ * + ? { } [ ] \ | ( )
</pre></div>
</div>
<p>정규 표현식에 메타 문자를 사용하면 특별한 기능을 갖는다.</p>
<div class="section" id="id12">
<h4><span class="section-number">9.2.2.1. </span>문자 클래스([ ])<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<p>정규 표현식에서 대괄호([ ])는 <strong>대괄호 안에 포함된 문자들 중 하나와 매치</strong>를 뜻한다. 예를 들어 ‘apple’, ‘blueberry’, ‘coconut’이 정규표현식이 [ae]와 어떻게 매치되는지 살펴보자.</p>
<ul class="simple">
<li><p>‘apple’에는 정규표현식 내의 a와 e가 모두 존재하므로 매치된다.</p></li>
<li><p>‘blueberry’에는 e가 존재하므로 매치된다.</p></li>
<li><p>‘coconut’에는 a와 e 중 어느 문자도 포함하고 있지 않으므로 매치되지 않는다.</p></li>
</ul>
<p>만일 [ ] 안의 두 문자 사이에 하이픈(-)을 입력하면 두 문자 사이의 범위를 의미한다. 즉 [a-e]라는 정규 표현식은 [abcde]와 동일하며, [0-5]는 [012345]와 동일하다. 흔히 [a-z]는 알파벳 소문자를, [A-Z]는 알파벳 대문자를, [a-zA-Z]는 모든 알파벳을, [0-9]는 모든 숫자를 뜻한다. 또한 [ ]안의 ^는 반대를 뜻한다. 즉 [^0-9]는 숫자를 제외한 문자만 매치를, [^abc]는 a,b,c를 제외한 모든 문자와 매치를 뜻한다.</p>
<p>자주 사용하는 문자 클래스의 경우 별도의 표기법이 존재하여 훨씬 간단하게 표현할 수 있다.</p>
<table class="colwidths-auto table" id="character-class">
<caption><span class="caption-number">Table 9.2 </span><span class="caption-text">자주 사용하는 문자 클래스</span><a class="headerlink" href="#character-class" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>문자 클래스</p></th>
<th class="head"><p>설명</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>\d</p></td>
<td><p>숫자와 매치, [0-9]와 동일한 표현식</p></td>
</tr>
<tr class="row-odd"><td><p>\D</p></td>
<td><p>숫자가 아닌 것 매치, [^0-9]와 동일한 표현식</p></td>
</tr>
<tr class="row-even"><td><p>\s</p></td>
<td><p>whitespace(공백) 문자와 매치, [ \t\n\r\f\v]와 동일한 표현식</p></td>
</tr>
<tr class="row-odd"><td><p>\S</p></td>
<td><p>whitespace 문자가 아닌 것과 매치, [^\t\n\r\f\v]와 동일한 표현식</p></td>
</tr>
<tr class="row-even"><td><p>\w</p></td>
<td><p>문자+숫자(alphanumeric)와 매치, [a-zA-Z0-9]와 동일한 표현식</p></td>
</tr>
<tr class="row-odd"><td><p>\W</p></td>
<td><p>문자+숫자(alphanumeric)가 아닌 문자와 매치, [^a-zA-Z0-9]와 동일한 표현식</p></td>
</tr>
</tbody>
</table>
<p><a class="reference internal" href="#character-class"><span class="std std-numref">Table 9.2</span></a>에서 알 수 있듯이 대문자로 표현된 문자 클래스는 소문자로 표현된 것의 반대를 의미한다.</p>
</div>
<div class="section" id="id13">
<h4><span class="section-number">9.2.2.2. </span>모든 문자(.)<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h4>
<p>Dot(.) 메타 문자는 줄바꿈 문자인 \n을 제외한 모든 문자와 매치되며, Dot 하나당 임의의 한 문자를 나타낸다. 정규 표현식 <code class="docutils literal notranslate"><span class="pre">a.e</span></code>는 ‘a+모든문자+e’의 형태다. 즉 a와 e 문자 사이에는 어떤 문자가 들어가도 모두 매치가 된다. ‘abe’, ‘ace’, ‘abate’, ‘ae’의 경우 정규식 <code class="docutils literal notranslate"><span class="pre">a.e</span></code>와 어떻게 매치되는지 살펴보자.</p>
<ul class="simple">
<li><p>‘abe’: a와 e 사이에 b라는 문자가 있으므로 정규식과 매치된다.</p></li>
<li><p>‘ace’: a와 e 사이에 c라는 문자가 있으므로 정규식과 매치된다.</p></li>
<li><p>‘abate’: a와 e 사이에 문자가 하나가 아닌 여러개가 있으므로 매치되지 않는다.</p></li>
<li><p>‘ae’: a와 e 사이에 문자가 없으므로 매치되지 않는다.</p></li>
</ul>
<p>만일 정규식이 a[.]c의 형태일 경우는 ‘a.c’를 의미한다. 즉 a와 c사이의 dot(.)은 모든 문자를 의미하는 것이 아닌 문자 그대로인 .를 의미한다.</p>
</div>
<div class="section" id="id14">
<h4><span class="section-number">9.2.2.3. </span>반복문<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h4>
<p>정규 표현식에는 반복을 의미하는 여러 메타문자가 존재한다. 먼저 <code class="docutils literal notranslate"><span class="pre">*</span></code>의 경우 <code class="docutils literal notranslate"><span class="pre">*</span></code> 바로 앞에 있는 문자가 0부터 무한대로 반복될 수 있다는 의미다.  <code class="docutils literal notranslate"><span class="pre">ca*t</span></code> 이라는 정규식은 c 다음의 a가 0부터 무한대로 반복되고 t로 끝이난다는 의미로, ‘ct’, ‘cat’, ‘caat’, ‘caaaat’ 모두 정규식과 매치된다.</p>
<p>반면 메타문자 <code class="docutils literal notranslate"><span class="pre">+</span></code>는 최소 1번 이상 반복될 때 사용된다. <code class="docutils literal notranslate"><span class="pre">ca+t</span></code> 라는 정규식은 c 다음의 a가 1번 이상 반복된 후 t로 끝남을 의미하며, 위 예제에서 ct는 a가 없으므로 매치되지 않는다.</p>
<p>메타문자 <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">}</span></code>를 사용하면 반복 횟수를 고정할 수 있다. 즉 {m, n}은 반복 횟수가 m부터 n까지 고정된다. m 혹은 n은 생략할 수도 있으며, {3, }의 경우 반복 횟수가 3 이상, {, 3}의 경우 반복 횟수가 3 이하를 의미한다.</p>
<p>메타문자 <code class="docutils literal notranslate"><span class="pre">?</span></code>는 {0, 1}과 동일하다. 즉 <code class="docutils literal notranslate"><span class="pre">?</span></code> 앞의 문자가 있어도 되고 없어도 된다는 의미다.</p>
</div>
<div class="section" id="id15">
<h4><span class="section-number">9.2.2.4. </span>기타 메타문자<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h4>
<p>이 외에도 정규 표현식에는 다양한 메타문자가 존재한다.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">|</span></code>: or과 동일한 의미다. 즉 <code class="docutils literal notranslate"><span class="pre">expr1</span> <span class="pre">|</span> <span class="pre">expr2</span></code>라는 정규식은 expr1 혹은 expr2 라는 의미로써, 둘 중 하나의 형태만 만족해도 매치가 된다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">^</span></code>: 문자열의 맨 처음과 일치함을 의미한다. 즉 <code class="docutils literal notranslate"><span class="pre">^a</span></code> 정규식은 a로 시작하는 단어와 매치가 된다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$</span></code>: <code class="docutils literal notranslate"><span class="pre">^</span></code>와 반대의 의미로써, 문자열의 끝과 매치함을 의미한다. 즉, <code class="docutils literal notranslate"><span class="pre">a$</span></code>는 a로 끝나는 단어와 매치가 된다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">\</span></code>: 메타문자의 성질을 없앨때 붙인다. 즉 <code class="docutils literal notranslate"><span class="pre">^</span></code>이나 <code class="docutils literal notranslate"><span class="pre">$</span></code> 문자를 메타문자가 아닌 문자 그 자체로 매치하고 싶은 경우 <code class="docutils literal notranslate"><span class="pre">\^</span></code>, <code class="docutils literal notranslate"><span class="pre">\$</span></code>의 형태로 사용한다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">()</span></code>: 괄호안의 문자열을 하나로 묶어 취급한다.</p></li>
</ul>
</div>
</div>
<div class="section" id="id16">
<h3><span class="section-number">9.2.3. </span>정규식을 이용한 문자열 검색<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h3>
<p>대략적인 정규 표현식을 익혔다면, 실제 예제를 통해 문자열을 검색하는 법을 알아보자. 파이썬에서는 re(regular expression) 모듈을 통해 정규 표현식을 사용할 수 있다. 정규 표현식과 관련된 메서드는 다음과 같다.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">match()</span></code>: 시작부분부터 일치하는 패턴을 찾는다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">search()</span></code>: 첫 번째 일치하는 패턴을 찾는다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">findall()</span></code>: 일치하는 모든 패턴을 찾는다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">finditer()</span></code>: <code class="docutils literal notranslate"><span class="pre">findall()</span></code>과 동일하지만 그 결과로 반복 가능한 객체를 반환한다.</p></li>
</ul>
<p>간단한 실습을 해보도록 하자.</p>
<div class="section" id="match">
<h4><span class="section-number">9.2.3.1. </span><code class="docutils literal notranslate"><span class="pre">match()</span></code><a class="headerlink" href="#match" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;[a-z]+&#39;</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>re.Pattern
</pre></div>
</div>
</div>
</div>
<p>파이썬에서는 re 모듈을 통해 정규 표현식을 사용할 수 있으며, <code class="docutils literal notranslate"><span class="pre">re.compile()</span></code>을 통해 정규 표현식을 컴파일하여 변수에 저장한 후 사용할 수 있다. <code class="docutils literal notranslate"><span class="pre">[a-z]+</span></code>는 알파벳 소문자가 1부터 여러개까지를 의미하는 표현식이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;re.Match object; span=(0, 6), match=&#39;python&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">match()</span></code> 함수를 통해 처음부터 정규 표현식과 일치하는 패턴을 찾을 수 있다. python이라는 단어는 알파벳이 여러개가 있는 경우이므로 match 객체를 반환한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;python&#39;
</pre></div>
</div>
</div>
</div>
<p>match 객체 뒤에 <code class="docutils literal notranslate"><span class="pre">group()</span></code>을 입력하면 매치된 텍스트만 출력할 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;Use python&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>None
</pre></div>
</div>
</div>
</div>
<p>‘Use python 이라는 문자열은 맨 처음의 문자 ‘U’가 대문자로써, 소문자를 의미하는 정규 표현식 <code class="docutils literal notranslate"><span class="pre">[a-z]+</span></code>와는 매치되지 않아 None을 반환한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;PYTHON&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>None
</pre></div>
</div>
</div>
</div>
<p>PYTHON이라는 단어는 대문자이므로 이 역시<code class="docutils literal notranslate"><span class="pre">[a-z]+</span></code>와는 매치되지 않는다. 이 경우 대문자에 해당하는 <code class="docutils literal notranslate"><span class="pre">[A-Z]+</span></code> 표현식을 사용해야 매치가 된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;[가-힣]+&#39;</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;파이썬&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;re.Match object; span=(0, 3), match=&#39;파이썬&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>한글의 경우 알파벳이 아니므로 모든 한글을 뜻하는 <code class="docutils literal notranslate"><span class="pre">[가-힣]+</span></code> 표현식을 사용하면 매치가 된다.</p>
</div>
<div class="section" id="search">
<h4><span class="section-number">9.2.3.2. </span><code class="docutils literal notranslate"><span class="pre">search()</span></code><a class="headerlink" href="#search" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">search()</span></code> 함수는 첫 번째 일치하는 패턴을 찾는다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;[a-z]+&#39;</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;re.Match object; span=(0, 6), match=&#39;python&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>‘python’이라는 문자에 search 메서드를 수행하면 match 메서드를 수행한 것과 결과가 동일하다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;Use python&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;re.Match object; span=(1, 3), match=&#39;se&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>‘Use python’ 문자의 경우 첫번째 문자인 ‘U’는 대문자라 매치가 되지 않지만, 그 이후의 문자열 ‘se’는 소문자로 구성되어 있기에 매치가 된다. 이처럼 <code class="docutils literal notranslate"><span class="pre">search()</span></code>는 문자열의 처음부터 검색하는 것이 아니라 문자열 전체를 검색하며, 첫 번째로 일치하는 패턴을 찾기에 띄어쓰기 이후의 ‘python’은 매치되지 않는다.</p>
</div>
<div class="section" id="findall">
<h4><span class="section-number">9.2.3.3. </span><code class="docutils literal notranslate"><span class="pre">findall()</span></code><a class="headerlink" href="#findall" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">findall()</span></code>은 하나가 아닌 일치하는 모든 패턴을 찾는다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;[a-zA-Z]+&#39;</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;Life is too short, You need Python.&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Life&#39;, &#39;is&#39;, &#39;too&#39;, &#39;short&#39;, &#39;You&#39;, &#39;need&#39;, &#39;Python&#39;]
</pre></div>
</div>
</div>
</div>
<p>이번에는 대소문자 모든 알파벳을 뜻하는 <code class="docutils literal notranslate"><span class="pre">[a-zA-Z]+</span></code> 표현식을 입력하였다. 그 후 ‘Life is too short, You need Python.’라는 문자에 <code class="docutils literal notranslate"><span class="pre">finall()</span></code> 메서드를 적용하면 정규 표현식과 매치되는 모든 단어를 리스트 형태도 반환한다.</p>
</div>
<div class="section" id="finditer">
<h4><span class="section-number">9.2.3.4. </span>finditer()<a class="headerlink" href="#finditer" title="Permalink to this headline">¶</a></h4>
<p>마지막으로 <code class="docutils literal notranslate"><span class="pre">findall()</span></code>과 비슷한 <code class="docutils literal notranslate"><span class="pre">finditer()</span></code> 함수의 결과를 살펴보자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;[a-zA-Z]+&#39;</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="s1">&#39;Life is too short, You need Python.&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;callable_iterator object at 0x0000022B9F40E730&gt;
</pre></div>
</div>
</div>
</div>
<p>결과를 살펴보면 반복 가능한 객체(iterator object)를 반환한다. 이는 for문을 통해 출력할 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">m</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;re.Match object; span=(0, 4), match=&#39;Life&#39;&gt;
&lt;re.Match object; span=(5, 7), match=&#39;is&#39;&gt;
&lt;re.Match object; span=(8, 11), match=&#39;too&#39;&gt;
&lt;re.Match object; span=(12, 17), match=&#39;short&#39;&gt;
&lt;re.Match object; span=(19, 22), match=&#39;You&#39;&gt;
&lt;re.Match object; span=(23, 27), match=&#39;need&#39;&gt;
&lt;re.Match object; span=(28, 34), match=&#39;Python&#39;&gt;
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="id17">
<h3><span class="section-number">9.2.4. </span>정규 표현식 연습해보기<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h3>
<p>위에서 배운 것들을 토대로 실제 크롤링 결과물 중 정규 표현식을 사용해 원하는 부분만 찾는 연습을 해보도록 하자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;r</span><span class="se">\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t</span><span class="s2">15</span><span class="se">\r\n\t\t\t\t\t\t\t\t</span><span class="s2">23</span><span class="se">\r\n\t\t\t\t\t\t\t\t</span><span class="s2">29</span><span class="se">\r\n\t\t\t\t\t\t\t\t</span><span class="s2">34</span><span class="se">\r\n\t\t\t\t\t\t\t\t</span><span class="s2">40</span><span class="se">\r\n\t\t\t\t\t\t\t\t</span><span class="s2">44</span><span class="se">\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t</span><span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>위의 HTML 결과물에서 숫자에 해당하는 부분만 추츨해보도록 하자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;[0-9]+&#39;</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;15&#39;, &#39;23&#39;, &#39;29&#39;, &#39;34&#39;, &#39;40&#39;, &#39;44&#39;]
</pre></div>
</div>
</div>
</div>
<p>\n, \t와 같은 문자를 없애는 방법으로 클렌징을 할 수도 있지만, 숫자를 의미하는 ‘[0-9]+’ 정규 표현식을 사용하면 훨씬 간단하게 추출할 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span> <span class="o">=</span> <span class="s1">&#39;&gt; 오늘의 날짜는 2022.12.31 입니다.&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>이번에는 위의 문장에서 날짜에 해당하는 ‘2022.12.31’ 혹은 ‘20221231’ 만 추출해보도록 하자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;[0-9]+.[0-9]+.[0-9]+&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;2022.12.31&#39;]
</pre></div>
</div>
</div>
</div>
<p>정규 표현식 ‘[0-9]+.[0-9]+.[0-9]+’은 [숫자.숫자.숫자] 형태를 의미하며, 이를 통해 ‘2022.12.31’을 추출한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;[0-9]+&#39;</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;2022&#39;, &#39;12&#39;, &#39;31&#39;]
</pre></div>
</div>
</div>
</div>
<p>정규 표현식에 <code class="docutils literal notranslate"><span class="pre">[0-9]+</span></code>을 입력할 경우 숫자가 개별로 추출되므로, 추가적인 작업을 통해 ‘20221231’ 형태로 만들어주면 된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;20221231&#39;
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">join()</span></code> 함수는 <code class="docutils literal notranslate"><span class="pre">'구분자'.join(리스트)</span></code> 형태이므로, 구분자에 ‘’를 입력하면 리스트 내의 모든 문자를 공백없이 합쳐서 반환한다.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>아래의 웹사이트에서 정규 표현식을 연습하고 테스트할 수 있다. 크롤링 후 내가 선택하고자 하는 문자를 한 번에 정규 표현식을 이용해 추출하는 것은 초보자 단계에서는 쉬운일이 아니므로, 아래 웹사이트에서 텍스트를 입력하고 이를 추출하는 정규 표현식을 알아낸 후, 이를 파이썬에 적용하는 것이 훨씬 효율성이 높다.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://regexr.com">https://regexr.com</a></p></li>
<li><p><a class="reference external" href="https://regex101.com">https://regex101.com</a></p></li>
</ul>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="crawl_basic.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">8. </span>정적 크롤링 실습하기</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="data_korea.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">10. </span>국내 주식 데이터 수집</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By 이현열<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>